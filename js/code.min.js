//common
window.onload = function() {
  var arr = [];
  var audio;
   //$("#k_ring")[0].play();
  function audioAutoPlay(id){
    audio = document.getElementById(id),
        play = function(){
          audio.play();
          document.removeEventListener("touchstart",play, false);
        };
    audio.play();
    document.addEventListener("WeixinJSBridgeReady", function () {
      play();
    }, false);
    document.addEventListener('YixinJSBridgeReady', function() {
      play();
    }, false);
    document.addEventListener("touchstart",play, false);
  }
  audioAutoPlay('k_ring');

  document.getElementById("load").style.display = "none";
  //init
  // isLottery();
  var isDelete = false;
  var myswiper= new Swiper("#swiper-container-v", {
    speed: 500,
    direction: "vertical",
    // pagination: ".swiper-pagination",
    mousewheelControl: !0,
    allowSwipeToNext : true,
    allowSwipeToPrev:true,
    // noSwipingClass : 'stop-swiping',
    onInit: function(a) {
        a.myactive = 0;
        for (var b = 0; b < a.slides.length; b++) a.slides[b].style.zIndex = 0;
        a.slides[a.myactive].style.zIndex = 1,
        swiperAnimateCache(a),
        swiperAnimate(a);

    },
    // onSlideChangeEnd: function(swiper){
    //    swiperAnimate(swiper); //每个slide切换结束时也运行当前slide动画
    // },

    onSlideChangeStart: function(swiper){
      swiperAnimate(swiper);
    },
    onSlideChangeEnd:function (swiper) {
      if(swiper.activeIndex == 5){
        $('.arrow-box').addClass('share_layer_hide');
      }else {
        $('.arrow-box').removeClass('share_layer_hide');
        $('.share_layer_bg').addClass('share_layer_hide');
      }
      if(swiper.activeIndex !=3){
        $('.icon_layer_op1').removeClass('shaji_flash');
        $('.icon_layer_op2').removeClass('xiaocang_flash');
        $('.icon_layer_op3').removeClass('caomei_flash');
        $('.page4_layer').animate({
          opacity:'0',
          left:'50%',
          top:'50%',
          height:'0px',
          width:'0px'
        });
      }else{
        $('.icon_layer_op1').attr('opacity',('0'));
        $('.icon_layer_op2').attr('opacity',('0'));
        $('.icon_layer_op3').attr('opacity',('0'));
        $('.icon_layer_op1').addClass('shaji_flash');
        $('.icon_layer_op2').addClass('xiaocang_flash');
        $('.icon_layer_op3').addClass('caomei_flash');
      }
    },
    // onTouchEnd:function(swiper){
    //   alert(swiper.activeIndex)
    //   if(swiper.activeIndex!=0){
    //     $(".top-box").addClass("visible");
    //     $(".top-box").removeClass("invisible");
    //   }
    //   swiperAnimate(swiper);
    // },
    onTransitionStart: function(a) {
        a.params.onlyExternal = !0
    },
    onTransitionEnd: function(a) {
        a.params.onlyExternal = !1,
        a.myactive = a.activeIndex;
        for (var b = 0; b < a.slides.length; b++) a.slides[b].style.zIndex = 0;
        a.slides[a.myactive].style.zIndex = 1,
        swiperAnimate(a)


    },
    //watchSlidesProgress: !0,
    // onProgress: function(a) {
    //     var b, c, d, e;
    //     for (a.myactive || (a.myactive = 0), b = 0; b < a.slides.length; b++) c = a.slides[b],
    //     es = c.style,
    //     d = c.progress,
    //     e = d * a.height,
    //     opacity = 0,
    //     b == a.myactive && (opacity = 1 - Math.abs(d) / 2),
    //     (a.slides[a.myactive].progress > 0 && b == a.myactive + 1 || a.slides[a.myactive].progress < 0 && b == a.myactive - 1) && (opacity = .5 + Math.abs(.5 * a.slides[a.myactive].progress)),
    //     c.style.opacity = opacity,
    //     b != a.myactive && (es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform = "translate3d(0," + e + "px,0)")
    // },
    onSetTransition: function(a, b) {
        for (var c = 0; c < a.slides.length; c++) es = a.slides[c].style,
        es.webkitTransitionDuration = es.MsTransitionDuration = es.msTransitionDuration = es.MozTransitionDuration = es.OTransitionDuration = es.transitionDuration = b + "ms"
    }
  });

  var h = document.body.clientHeight + 'px';
  var w = document.body.clientWidth + 'px';
  $('.page4_xiaocang').bind('touchend',function(event){
    $('.layer_shaji').addClass('share_layer_hide');
    $('.layer_caomei').addClass('share_layer_hide');
    $('.layer_xiaocang').removeClass('share_layer_hide');
      setTimeout(function(){
        $('.page4_layer').animate({
          opacity:'1',
          left:'0%',
          top:'0%',
          height:h,
          width:w
        });
      });
  });
  $('.page4_shaji').bind('touchend',function(event){
    $('.layer_xiaocang').addClass('share_layer_hide');
    $('.layer_caomei').addClass('share_layer_hide');
    $('.layer_shaji').removeClass('share_layer_hide');
      setTimeout(function(){
        $('.page4_layer').animate({
          opacity:'1',
          left:'0%',
          top:'0%',
          height:h,
          width:w
        });
      });

  });
  $('.page4_caomei').bind('touchend',function(event){
    $('.layer_shaji').addClass('share_layer_hide');
    $('.layer_xiaocang').addClass('share_layer_hide');
    $('.layer_caomei').removeClass('share_layer_hide');
      setTimeout(function(){
        $('.page4_layer').animate({
          opacity:'1',
          left:'0%',
          top:'0%',
          height:h,
          width:w
        });
      });
  });

  $('.layerClose').bind('touchend',function(event){
    $('.page4_layer').animate({
      opacity:'0',
      left:'50%',
      top:'50%',
      height:'0px',
      width:'0px'
    });
  });
  $('.share_button').bind('touchend',function(event){
    $('.share_layer_bg').removeClass('share_layer_hide');
  });
  $('.share_layer_bg').bind('touchend',function(event){
    $('.share_layer_bg').addClass('share_layer_hide');
    event.stopPropagation();
  });
  $('.music').bind('touchend',function(event){
    if($('.music').hasClass('musirotate')){
      $('.music').removeClass('musirotate');
      audio.pause();
    }else {
      $('.music').addClass('musirotate');
      audio.play();
    }
  });
};
